#!/usr/bin/env python3
"""
Russian Loto Number Announcer with Celebrity Voice Cloning
Uses Qwen3-TTS to clone voices of Russian celebrities
Each celebrity has their own style of jokes fitting their persona
"""

import asyncio
import random
import tempfile
import os
import time
import threading
from pathlib import Path
from typing import Optional
import requests

import numpy as np
import pygame

# Try to import PyAudio for microphone listening
try:
    import pyaudio
    PYAUDIO_AVAILABLE = True
except ImportError:
    PYAUDIO_AVAILABLE = False

# Try to import Qwen TTS, fall back to edge-tts if not available
QWEN_AVAILABLE = False
QWEN_DEVICE = "cpu"
QWEN_DTYPE = None

try:
    import torch
    import soundfile as sf
    from qwen_tts import Qwen3TTSModel
    QWEN_AVAILABLE = True

    # Determine best device for Qwen3-TTS
    if torch.cuda.is_available():
        QWEN_DEVICE = "cuda:0"
        QWEN_DTYPE = torch.bfloat16
        print("  [Qwen TTS: NVIDIA CUDA detected]")
    elif torch.backends.mps.is_available():
        # MPS (Apple Silicon) works with float32 (float16 causes numerical issues)
        QWEN_DEVICE = "mps"
        QWEN_DTYPE = torch.float32
        print("  [Qwen TTS: Apple Silicon MPS GPU]")
    else:
        QWEN_DEVICE = "cpu"
        QWEN_DTYPE = torch.float32
        print("  [Qwen TTS: CPU mode]")
except ImportError:
    import edge_tts

# Celebrity voice samples - short clips for voice cloning
# Each celebrity has a sample URL and transcript for better cloning
# Voice samples should be placed in ./voices/ directory
VOICES_DIR = Path(__file__).parent / "voices"

CELEBRITY_VOICES = {
    "brezhnev": {
        "name": "Леонид Брежнев",
        "description": "Генеральный секретарь, медленная речь с паузами",
        "sample_text": "Дорогие товарищи! Сегодня мы собрались здесь, чтобы отметить этот знаменательный день.",
        "sample_file": "brezhnev.mp3",  # Place your sample in ./voices/
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "-30%",  # Very slow, deliberate
        "edge_pitch": "-10Hz",  # Lower pitch
        "style": "soviet_leader",
        "voice_design": "A deep elderly male Russian voice, slow deliberate speech with long pauses, authoritative Soviet leader tone, native Russian speaker with clear pronunciation",
    },
    "galkin": {
        "name": "Максим Галкин",
        "description": "Пародист, шоумен, энергичный и театральный",
        "sample_text": "Дамы и господа! А сейчас будет самое интересное! Внимание!",
        "sample_file": "galkin.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "+20%",  # Fast, energetic
        "edge_pitch": "+5Hz",  # Slightly higher
        "style": "showman",
        "voice_design": "A young energetic male Russian voice, theatrical showman style, fast and lively speech, native Russian speaker with expressive intonation",
    },
    "pugacheva": {
        "name": "Алла Пугачёва",
        "description": "Примадонна российской эстрады, дива",
        "sample_text": "Ну что, мои дорогие? Начинаем! Это будет незабываемо!",
        "sample_file": "pugacheva.mp3",
        "edge_voice": "ru-RU-SvetlanaNeural",  # Female voice
        "edge_rate": "+5%",
        "edge_pitch": "+0Hz",
        "style": "diva",
        "voice_design": "A mature female Russian voice, diva pop star style, dramatic and expressive, native Russian speaker with theatrical flair",
    },
    "vinni": {
        "name": "Винни-Пух (Евгений Леонов)",
        "description": "Советский мультфильм, добродушный медвежонок",
        "sample_text": "Кто ходит в гости по утрам, тот поступает мудро.",
        "sample_file": "vinni.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "-15%",  # Slow, thoughtful
        "edge_pitch": "-5Hz",  # Warm, lower
        "style": "bear",
        "voice_design": "A warm friendly male Russian voice, gentle and kind like a cartoon bear, slow thoughtful speech, native Russian speaker with cozy warm tone",
    },
    "zhirinovsky": {
        "name": "Владимир Жириновский",
        "description": "Политик, экспрессивный оратор",
        "sample_text": "Я вам так скажу! Это безобразие! Хватит это терпеть!",
        "sample_file": "zhirinovsky.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "+30%",  # Very fast, passionate
        "edge_pitch": "+10Hz",  # Higher, more intense
        "style": "politician",
        "voice_design": "An intense loud male Russian voice, passionate political speaker style, fast aggressive speech with emotional outbursts, native Russian speaker",
    },
    "monetochka": {
        "name": "Монеточка",
        "description": "Инди-поп певица, молодёжный сленг, ироничная",
        "sample_text": "Привет! Это типа очень круто! Вайб такой классный!",
        "sample_file": "monetochka.mp3",
        "edge_voice": "ru-RU-SvetlanaNeural",
        "edge_rate": "+15%",
        "edge_pitch": "+15Hz",  # Young, high voice
        "style": "indie_singer",
        "voice_design": "A young energetic female Russian voice, indie pop singer style, playful ironic tone with Gen-Z slang, native Russian speaker with melodic intonation",
    },
    "gorshok": {
        "name": "Король и Шут (Горшок)",
        "description": "Панк-рок, театральный хоррор-стиль",
        "sample_text": "Ха-ха-ха! Добро пожаловать в наш безумный мир! Эй!",
        "sample_file": "gorshok.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "+10%",
        "edge_pitch": "+5Hz",
        "style": "punk_theatrical",
        "voice_design": "A theatrical dramatic male Russian voice, punk rock horror style, expressive with dark humor and maniacal laughs, native Russian speaker with theatrical flair",
    },
    "vysotsky": {
        "name": "Владимир Высоцкий",
        "description": "Легендарный бард, хриплый голос, поэт",
        "sample_text": "Друзья мои! Споём о главном! О жизни и о правде!",
        "sample_file": "vysotsky.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "-10%",
        "edge_pitch": "-15Hz",  # Deep, raspy
        "style": "bard",
        "voice_design": "A deep raspy male Russian voice, legendary Soviet bard style, emotional poetic delivery with slight hoarseness, native Russian speaker with soulful intensity",
    },
    "shnurov": {
        "name": "Сергей Шнуров (Ленинград)",
        "description": "Рок-музыкант, провокатор, острый юмор",
        "sample_text": "Эй! Что за дела?! Давайте веселиться! Лабутены!",
        "sample_file": "shnurov.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "+20%",
        "edge_pitch": "+0Hz",
        "style": "rocker",
        "voice_design": "A rough energetic male Russian voice, rock star provocateur style, sharp wit with occasional swearing undertones, native Russian speaker with street attitude",
    },
    "kirkorov": {
        "name": "Филипп Киркоров",
        "description": "Поп-король, эпатажный, драматичный",
        "sample_text": "Дорогие мои! Это будет незабываемо! Феерично! Грандиозно!",
        "sample_file": "kirkorov.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "+5%",
        "edge_pitch": "+10Hz",
        "style": "pop_king",
        "voice_design": "A dramatic flamboyant male Russian voice, pop star diva style, theatrical and grandiose with extravagant expressions, native Russian speaker with showman energy",
    },
    "leps": {
        "name": "Григорий Лепс",
        "description": "Рок-баллады, мощный голос, эмоциональный",
        "sample_text": "Эээй! Душа поёт! Слушайте сердцем!",
        "sample_file": "leps.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "-5%",
        "edge_pitch": "-10Hz",
        "style": "rock_ballad",
        "voice_design": "A powerful emotional male Russian voice, rock ballad singer style, deep and soulful with dramatic pauses, native Russian speaker with passionate delivery",
    },
    "baskov": {
        "name": "Николай Басков",
        "description": "Оперный поп-тенор, романтичный",
        "sample_text": "Друзья! Любовь и музыка! Это прекрасно!",
        "sample_file": "baskov.mp3",
        "edge_voice": "ru-RU-DmitryNeural",
        "edge_rate": "+0%",
        "edge_pitch": "+20Hz",  # High tenor
        "style": "tenor",
        "voice_design": "A high melodic male Russian voice, operatic pop tenor style, romantic and sweet with classical training undertones, native Russian speaker with lyrical quality",
    },
}

# Character-specific jokes that fit their persona
# Brezhnev: Soviet bureaucratic humor, awards, "дорогие товарищи"
# Galkin: Theatrical parodist style, showman energy
# Pugacheva: Diva attitude, "мои дорогие", theatrical
# Vinni-Puh: Honey, friends, simple wisdom, "а не пойти ли нам..."
# Zhirinovsky: Political outbursts, "безобразие!", expressive

LOTO_JOKES = {
    1: {
        "brezhnev": "Единица... Как один орден на груди... Маловато будет, дорогие товарищи! Номер один!",
        "galkin": "Один! Единственный и неповторимый! Как я на этой сцене! Единица!",
        "pugacheva": "Номер один! Как я в чартах! Примадонна чисел! Единичка!",
        "vinni": "Один... Это как один горшочек мёда. Грустно! Маловато будет! Единица!",
        "zhirinovsky": "Один! Я вам так скажу - один в поле не воин! Но мы справимся! Единица!",
        "monetochka": "Один! Это типа базовый вайб! Минимализм! Единичка!",
        "gorshok": "Один! Ха-ха! Один в темноте! Один в ночи! Страшно? Единица!",
        "vysotsky": "Один... Один на один с судьбой. Так и живём, друзья. Единица!",
        "shnurov": "Один! Один - это норм! Зато никто не мешает! Единица!",
        "kirkorov": "Один! Единственный и неповторимый! Как я! Грандиозная единица!",
        "leps": "Один... Один в душе... Один в ночи... Но мы сильные! Единица!",
        "baskov": "Один! Соло! Ария одинокого сердца! Прекрасная единица!",
    },
    2: {
        "brezhnev": "Два... Как две звезды Героя Советского Союза... Двойка, товарищи!",
        "galkin": "Лебедь грациозный! Два! Как две половинки одного шоу! Двойка!",
        "pugacheva": "Два! Дуэт! Как мы с Филиппом! Красивое число! Двоечка!",
        "vinni": "Два... Два горшочка - уже лучше! Можно поделиться с Пятачком! Два!",
        "zhirinovsky": "Два! Двоевластие - это безобразие! Но число хорошее! Двойка!",
        "monetochka": "Два! Это как пара кроссовок! Классика! Двоечка!",
        "gorshok": "Два! Два глаза в темноте! Кто там? Ха-ха-ха! Двойка!",
        "vysotsky": "Два... Мы вдвоём с тобой, товарищ. Вместе легче! Два!",
        "shnurov": "Два! Два лабутена! Ну вы поняли! Двойка!",
        "kirkorov": "Два! Дуэт! Феерия! Я и моё отражение! Двоечка!",
        "leps": "Два... Два сердца бьются в унисон... Красиво! Два!",
        "baskov": "Два! Дуэт тенора и сопрано! Гармония! Двойка!",
    },
    3: {
        "brezhnev": "Три... Триединство партии, народа и армии! Тройка, дорогие товарищи!",
        "galkin": "Три! На троих соображаем по-русски! Классика! Тройка удалая!",
        "pugacheva": "Три желания! Три аккорда! Три концерта в день! Тройка!",
        "vinni": "Три... Я, Пятачок и Кролик - хорошая компания для чаепития! Три!",
        "zhirinovsky": "Три! Три раза я вам говорю - хватит это терпеть! Тройка!",
        "monetochka": "Три! Как три хайповых трека! Топ! Тройка!",
        "gorshok": "Три! Три ведьмы варят зелье! Буль-буль! Тройка!",
        "vysotsky": "Три... Три товарища в окопе. Святое число! Три!",
        "shnurov": "Три! На троих! Русская традиция! Тройка!",
        "kirkorov": "Три! Три костюма за концерт! Минимум! Тройка!",
        "leps": "Три... Три аккорда правды... Душа поёт! Три!",
        "baskov": "Три! Три тенора! Паваротти, Доминго и я! Тройка!",
    },
    4: {
        "brezhnev": "Четыре... Четыре года пятилетки... Перевыполним! Четвёрка!",
        "galkin": "Стул на четырёх ножках! Устойчиво! Как моя карьера! Четыре!",
        "pugacheva": "Четыре! Четыре времени года! Каждое - для новой песни! Четвёрка!",
        "vinni": "Четыре лапы... Ой, у меня же две! Но мёда всё равно хочется! Четыре!",
        "zhirinovsky": "Четыре! Четыре стороны света! И везде нужен порядок! Четвёрка!",
        "monetochka": "Четыре! Четыре сезона аниме! Кайф! Четвёрка!",
        "gorshok": "Четыре! Четыре всадника Апокалипсиса! Скачут! Четвёрка!",
        "vysotsky": "Четыре... Четыре стены. А за ними - воля! Четыре!",
        "shnurov": "Четыре! Четыре утра - пора домой! Четвёрка!",
        "kirkorov": "Четыре! Четыре перемены костюмов! Это только начало! Четыре!",
        "leps": "Четыре... Четыре струны контрабаса... Глубина! Четыре!",
        "baskov": "Четыре! Квартет! Красивое звучание! Четвёрка!",
    },
    5: {
        "brezhnev": "Пять... Пятилетка! Выполним и перевыполним план! Пятёрка!",
        "galkin": "Пятёрка! Отличник! Как я в школе пародистов! Пять!",
        "pugacheva": "Пять! Пять октав! Ну, почти! Пятёрочка!",
        "vinni": "Пять... Пять горшочков мёда - вот это праздник! Пятёрка!",
        "zhirinovsky": "Пять! Пять минут на выступление?! Это безобразие! Мне нужен час! Пять!",
        "monetochka": "Пять! Оценка за вайб! Пятёрочка!",
        "gorshok": "Пять! Пять пальцев тянутся из могилы! Ха-ха! Пять!",
        "vysotsky": "Пять... Пять минут до атаки. Готовы, братцы! Пять!",
        "shnurov": "Пять! Пятёрка за поведение! Впервые! Пять!",
        "kirkorov": "Пять! Пять звёзд! Как мой райдер! Только лучшее! Пятёрка!",
        "leps": "Пять... Пять нот в душе... Музыка жизни! Пять!",
        "baskov": "Пять! Пять октав! Как у лучших теноров! Пятёрка!",
    },
    6: {
        "brezhnev": "Шесть... Шестидесятые годы... Хорошее время было, товарищи! Шестёрка!",
        "galkin": "Шесть! В домино пусто-шесть! А у нас полный аншлаг! Шестёрка!",
        "pugacheva": "Шесть струн на гитаре! Романтика! Шестёрочка!",
        "vinni": "Шесть... Шесть пчёлок - это уже много! Осторожно надо! Шесть!",
        "zhirinovsky": "Шесть! Шестой раз повторяю! Слушайте внимательно! Шестёрка!",
        "monetochka": "Шесть! Шесть лайков? Маловато! Шестёрка!",
        "gorshok": "Шесть! Шесть шесть шесть! Число зверя рядом! Шестёрка!",
        "vysotsky": "Шесть... Шесть струн гитары. Вся правда в них! Шесть!",
        "shnurov": "Шесть! Шесть утра - ещё не спал! Шестёрка!",
        "kirkorov": "Шесть! Шесть перьев в головном уборе! Минимум! Шесть!",
        "leps": "Шесть... Шесть струн души моей... Звенят! Шесть!",
        "baskov": "Шесть! Шесть теноров в одном зале! Конкуренция! Шестёрка!",
    },
    7: {
        "brezhnev": "Семь... Семь десятилетий Советской власти... Слава КПСС! Семёрка!",
        "galkin": "Семь! Семь чудес света! Восьмое чудо - это наше шоу! Семёрка!",
        "pugacheva": "Семь нот! До, ре, ми, фа, соль, ля, си! Семёрочка волшебная!",
        "vinni": "Семь... За семью морями говорят мёд слаще... Надо проверить! Семь!",
        "zhirinovsky": "Семь! Семь раз отмерь, один раз отрежь! Мудрость! Семёрка!",
        "monetochka": "Семь! Семь дней без интернета! Кошмар! Семёрка!",
        "gorshok": "Семь! Семь смертных грехов! Выбирай любой! Ха-ха! Семь!",
        "vysotsky": "Семь... Семь вёрст до небес. И всё лесом! Семь!",
        "shnurov": "Семь! Семь пятниц на неделе! Праздник! Семёрка!",
        "kirkorov": "Семь! Семь нот для моего голоса! Мало! Семь!",
        "leps": "Семь... Семь нот... Семь цветов радуги... Красота! Семь!",
        "baskov": "Семь! Семь октав! Мечта любого певца! Семёрка!",
    },
    8: {
        "brezhnev": "Восемь... Восемьдесят лет мне скоро... Эх, товарищи! Восьмёрка!",
        "galkin": "Восемь! Бесконечность набок! Как мой талант! Восьмёрка!",
        "pugacheva": "Восемь! Как талия в молодости! Эх, было время! Восьмёрочка!",
        "vinni": "Восемь... Восемь - это как два бублика! Вкусно пахнет! Восемь!",
        "zhirinovsky": "Восемь! Восемь часов работы?! Я работаю двадцать четыре! Восьмёрка!",
        "monetochka": "Восемь! Бесконечность на боку! Философия! Восьмёрка!",
        "gorshok": "Восемь! Восемь ног у паука! Ползёт к тебе! Восемь!",
        "vysotsky": "Восемь... Восьмого марта цветы женщинам! Важно! Восемь!",
        "shnurov": "Восемь! Восемь бокалов - это только начало! Восьмёрка!",
        "kirkorov": "Восемь! Восемь танцоров на сцене! Мало! Нужно шестнадцать! Восемь!",
        "leps": "Восемь... Бесконечность... Как моя любовь к музыке! Восемь!",
        "baskov": "Восемь! Восемь марта - праздник! Цветы дамам! Восьмёрка!",
    },
    9: {
        "brezhnev": "Девять... Девятого мая - День Победы! Никогда не забудем! Девятка!",
        "galkin": "Девять! Перевернёшь - шестёрка! Магия чисел! Девятка!",
        "pugacheva": "Девять муз! И я - десятая! Шучу! Девяточка!",
        "vinni": "Девять... Девять - это шесть, которая встала на голову! Смешно! Девять!",
        "zhirinovsky": "Девять! Девять из десяти согласны со мной! Остальные ошибаются! Девятка!",
        "monetochka": "Девять! Девять жизней как у кошки! Мяу! Девятка!",
        "gorshok": "Девять! Девять кругов ада! Данте знал толк! Девять!",
        "vysotsky": "Девять... Девятого мая - святой день! Помним! Девятка!",
        "shnurov": "Девять! Девять грамм свинца! Шутка! Девятка!",
        "kirkorov": "Девять! Девять костюмов за шоу! Рекорд! Девятка!",
        "leps": "Девять... Девятый вал... Мощь! Сила! Девять!",
        "baskov": "Девять! Девять муз вдохновляют меня! Девяточка!",
    },
    10: {
        "brezhnev": "Десять... Десять медалей на груди... Бряк-бряк-бряк... Десятка!",
        "galkin": "Десять! Бычий глаз! Червонец! В яблочко! Десятка!",
        "pugacheva": "Десять баллов из десяти! Как все мои концерты! Десяточка!",
        "vinni": "Десять... Десять пальцев - много мёда можно зачерпнуть! Десятка!",
        "zhirinovsky": "Десять! Десять процентов рейтинга?! Это фальсификация! Десятка!",
        "monetochka": "Десять! Десятка! Топ-10! В тренде! Круто!",
        "gorshok": "Десять! Десять негритят! Помнишь чем кончилось? Ха-ха! Десятка!",
        "vysotsky": "Десять... Десять шагов до рассвета. Дойдём! Десятка!",
        "shnurov": "Десять! Червонец! На пиво хватит! Десятка!",
        "kirkorov": "Десять! Десять баллов! Идеально! Как я! Десяточка!",
        "leps": "Десять... Десять пальцев на гитаре... Мелодия жизни! Десять!",
        "baskov": "Десять! Высший балл! Совершенство! Десяточка!",
    },
    11: {
        "brezhnev": "Одиннадцать... Как два столба на параде... Одиннадцать, товарищи!",
        "galkin": "Барабанные палочки! Та-да-дам! Одиннадцать!",
        "pugacheva": "Одиннадцать! Две единички держатся за ручки! Мило! Одиннадцать!",
        "vinni": "Одиннадцать... Как два дерева рядом! Под ними можно отдохнуть! Одиннадцать!",
        "zhirinovsky": "Одиннадцать! Одиннадцать друзей Оушена! Криминал! Но талантливо! Одиннадцать!",
        "monetochka": "Одиннадцать! Два столбика! Как палки для селфи! Одиннадцать!",
        "gorshok": "Одиннадцать! Два скелета стоят! Обнимаются! Одиннадцать!",
        "vysotsky": "Одиннадцать... Два друга плечом к плечу! Вместе! Одиннадцать!",
        "shnurov": "Одиннадцать! Барабанные палочки! Тыц-тыц! Одиннадцать!",
        "kirkorov": "Одиннадцать! Два прожектора на меня! Мало! Одиннадцать!",
        "leps": "Одиннадцать... Две свечи горят... Романтика! Одиннадцать!",
        "baskov": "Одиннадцать! Два голоса в унисон! Дуэт! Одиннадцать!",
    },
    12: {
        "brezhnev": "Двенадцать... Двенадцать республик было... Потом добавили... Дюжина!",
        "galkin": "Дюжина! Двенадцать стульев! Классика Ильфа и Петрова! Двенадцать!",
        "pugacheva": "Двенадцать! Полночь! Карета в тыкву! Но я всё равно королева! Двенадцать!",
        "vinni": "Двенадцать... Дюжина пирожков! Это много! Вкусно! Двенадцать!",
        "zhirinovsky": "Двенадцать! Двенадцать присяжных! Суд народа! Двенадцать!",
        "monetochka": "Двенадцать! Полночь! Тыква-карета! Сказка! Дюжина!",
        "gorshok": "Двенадцать! Полночь! Ведьмы вылетают! Берегись! Двенадцать!",
        "vysotsky": "Двенадцать... Дюжина верных друзей! Богатство! Двенадцать!",
        "shnurov": "Двенадцать! Дюжина пива! Вечеринка! Двенадцать!",
        "kirkorov": "Двенадцать! Дюжина роз! Для каждой поклонницы! Двенадцать!",
        "leps": "Двенадцать... Полночь... Час откровений! Двенадцать!",
        "baskov": "Двенадцать! Двенадцать месяцев! Каждый с новой песней! Дюжина!",
    },
    13: {
        "brezhnev": "Тринадцать... Чёртова дюжина... Но мы, коммунисты, не суеверны! Тринадцать!",
        "galkin": "Чёртова дюжина! Пятница тринадцатое! Но мы не боимся! Тринадцать!",
        "pugacheva": "Тринадцать! Не боюсь примет! Я сама примета! Тринадцать!",
        "vinni": "Тринадцать... Говорят, несчастливое... Но мёд-то есть! Значит счастье! Тринадцать!",
        "zhirinovsky": "Тринадцать! Суеверия - это безобразие! Наука побеждает! Тринадцать!",
        "monetochka": "Тринадцать! Чёртова дюжина! Но это типа эстетика! Тринадцать!",
        "gorshok": "Тринадцать! Моё любимое число! Ха-ха-ха! Пятница тринадцатое! Тринадцать!",
        "vysotsky": "Тринадцать... Чёртова дюжина. Но мы прорвёмся! Тринадцать!",
        "shnurov": "Тринадцать! Чёртова дюжина! Самое то! Тринадцать!",
        "kirkorov": "Тринадцать! Я не суеверен! Талант защищает! Тринадцать!",
        "leps": "Тринадцать... Не верю в приметы! Верю в музыку! Тринадцать!",
        "baskov": "Тринадцать! Тринадцать нот? Придумаем новые! Тринадцать!",
    },
    14: {
        "brezhnev": "Четырнадцать... Дважды семь... Математика, товарищи! Четырнадцать!",
        "galkin": "Четырнадцать! Два раза по семь! Двойная удача! Четырнадцать!",
        "pugacheva": "Четырнадцать февраля! День влюблённых! Романтика! Четырнадцать!",
        "vinni": "Четырнадцать... Это сколько же шагов до дома Кролика! Четырнадцать!",
        "zhirinovsky": "Четырнадцать! Четырнадцать лет - подросток! Молодёжь - наше будущее! Четырнадцать!",
        "monetochka": "Четырнадцать! Валентинов день! Сердечки! Четырнадцать!",
        "gorshok": "Четырнадцать! День влюблённых! Даже мертвецы любят! Четырнадцать!",
        "vysotsky": "Четырнадцать... Дважды семь. Двойная сила! Четырнадцать!",
        "shnurov": "Четырнадцать! Четырнадцатое февраля! Цветы втридорога! Четырнадцать!",
        "kirkorov": "Четырнадцать! День всех влюблённых в меня! Четырнадцать!",
        "leps": "Четырнадцать... Четырнадцатое февраля... Любовь! Четырнадцать!",
        "baskov": "Четырнадцать! День святого Валентина! Романс! Четырнадцать!",
    },
    15: {
        "brezhnev": "Пятнадцать... Три пятилетки... Трудовой подвиг! Пятнадцать!",
        "galkin": "Пятнадцать! Три пятёрки! Круглый отличник! Пятнадцать!",
        "pugacheva": "Пятнадцать минут славы! Хотя мне нужна вечность! Пятнадцать!",
        "vinni": "Пятнадцать... Если разделить на пятерых - всем по три горшочка! Пятнадцать!",
        "zhirinovsky": "Пятнадцать! Пятнадцать минут на обед?! Это издевательство! Пятнадцать!",
        "monetochka": "Пятнадцать! Пятнадцать минут славы! Мне хватит! Пятнадцать!",
        "gorshok": "Пятнадцать! Пятнадцать ударов кинжалом! Романтика! Пятнадцать!",
        "vysotsky": "Пятнадцать... Три по пять. По-нашему! Пятнадцать!",
        "shnurov": "Пятнадцать! Пятнадцать человек на сундук! Пираты! Пятнадцать!",
        "kirkorov": "Пятнадцать! Пятнадцать платьев за тур! Мало! Пятнадцать!",
        "leps": "Пятнадцать... Три пятёрки... Сила числа! Пятнадцать!",
        "baskov": "Пятнадцать! Квинтет плюс децимет! Ансамбль! Пятнадцать!",
    },
    16: {
        "brezhnev": "Шестнадцать... Шестнадцать республик... Дружба народов! Шестнадцать!",
        "galkin": "Sweet sixteen! Сладкие шестнадцать лет! Юность! Шестнадцать!",
        "pugacheva": "Шестнадцать! Когда я была юной звездой! Эх, молодость! Шестнадцать!",
        "vinni": "Шестнадцать... Шестнадцать шагов до дуба с мёдом! Близко! Шестнадцать!",
        "zhirinovsky": "Шестнадцать! Шестнадцать лет - паспорт! Ответственность! Шестнадцать!",
        "monetochka": "Шестнадцать! Свит сикстин! Тусовка! Шестнадцать!",
        "gorshok": "Шестнадцать! Шестнадцать свечей на торте! Задуй! Шестнадцать!",
        "vysotsky": "Шестнадцать... Молодость! Сила! Вперёд! Шестнадцать!",
        "shnurov": "Шестнадцать! Шестнадцать тонн! Как в песне! Шестнадцать!",
        "kirkorov": "Шестнадцать! Шестнадцать танцоров! Минимум для номера! Шестнадцать!",
        "leps": "Шестнадцать... Юность... Мечты... Всё впереди! Шестнадцать!",
        "baskov": "Шестнадцать! Сладкие шестнадцать! Романтика юности! Шестнадцать!",
    },
    17: {
        "brezhnev": "Семнадцать... Семнадцатый год... Великая революция! Семнадцать!",
        "galkin": "Семнадцать! Где мои семнадцать лет! Эх, молодость! Семнадцать!",
        "pugacheva": "Семнадцать мгновений весны! Штирлиц! Семнадцать!",
        "vinni": "Семнадцать... Почти взрослый медвежонок уже! Семнадцать!",
        "zhirinovsky": "Семнадцать! Год революции! История! Семнадцать!",
        "monetochka": "Семнадцать! Семнадцать лет! Выпускной! Семнадцать!",
        "gorshok": "Семнадцать! Семнадцать мгновений ужаса! Бу! Семнадцать!",
        "vysotsky": "Семнадцать... Год перелома! Судьба страны! Семнадцать!",
        "shnurov": "Семнадцать! Где мои семнадцать лет! На Большом Каретном! Семнадцать!",
        "kirkorov": "Семнадцать! Семнадцать мгновений моей славы! Семнадцать!",
        "leps": "Семнадцать... Мгновения весны... Штирлиц! Семнадцать!",
        "baskov": "Семнадцать! Возраст первой любви! Романтика! Семнадцать!",
    },
    18: {
        "brezhnev": "Восемнадцать... Совершеннолетие... В партию можно вступать! Восемнадцать!",
        "galkin": "Восемнадцать! Паспорт! Голосовать! Взрослая жизнь! Восемнадцать!",
        "pugacheva": "Восемнадцать! Совершеннолетие! Сама себе хозяйка! Восемнадцать!",
        "vinni": "Восемнадцать... Уже можно в гости без спроса ходить! Восемнадцать!",
        "zhirinovsky": "Восемнадцать! Право голоса! Демократия! Восемнадцать!",
        "monetochka": "Восемнадцать! Взрослая жизнь! Ответственность! Восемнадцать!",
        "gorshok": "Восемнадцать! Совершеннолетие! Теперь можно в бар! Ха! Восемнадцать!",
        "vysotsky": "Восемнадцать... В бой идут одни старики! Молодость! Восемнадцать!",
        "shnurov": "Восемнадцать! Наконец-то можно всё! Восемнадцать!",
        "kirkorov": "Восемнадцать! Взрослая жизнь начинается! Готовы к славе? Восемнадцать!",
        "leps": "Восемнадцать... Порог взрослой жизни... Вперёд! Восемнадцать!",
        "baskov": "Восемнадцать! Совершеннолетие! Новая глава! Восемнадцать!",
    },
    19: {
        "brezhnev": "Девятнадцать... Девятнадцатый съезд помню хорошо... Девятнадцать!",
        "galkin": "Девятнадцать! Почти двадцать! На пороге круглой даты! Девятнадцать!",
        "pugacheva": "Девятнадцать! На пороге новой декады! Волнительно! Девятнадцать!",
        "vinni": "Девятнадцать... Один шаг до двадцати горшочков мёда! Девятнадцать!",
        "zhirinovsky": "Девятнадцать! Последний год юности! Вперёд! Девятнадцать!",
        "monetochka": "Девятнадцать! Почти двадцатка! Ещё молодая! Девятнадцать!",
        "gorshok": "Девятнадцать! Девятнадцать жертв! Шутка! Девятнадцать!",
        "vysotsky": "Девятнадцать... Ещё не двадцать. Ещё есть время! Девятнадцать!",
        "shnurov": "Девятнадцать! Последний год без совести! Шутка! Девятнадцать!",
        "kirkorov": "Девятнадцать! На пороге двадцати! Волнение! Девятнадцать!",
        "leps": "Девятнадцать... Шаг до двадцати... Жизнь летит! Девятнадцать!",
        "baskov": "Девятнадцать! Юность! Романтика! Мечты! Девятнадцать!",
    },
    20: {
        "brezhnev": "Двадцать... Двадцатые годы были... Разные... Двадцать, товарищи!",
        "galkin": "Двадцать! Лебединое озеро! Чайковский! Балет! Двадцать!",
        "pugacheva": "Двадцать! Ревущие двадцатые! Мода! Стиль! Двадцать!",
        "vinni": "Двадцать... Два нуля, но второй куда-то делся... Странно! Двадцать!",
        "zhirinovsky": "Двадцать! Двадцатый век был наш! Двадцать первый тоже будет! Двадцать!",
        "monetochka": "Двадцать! Двадцатые! Наше время! Вайб! Двадцать!",
        "gorshok": "Двадцать! Ревущие двадцатые! Джаз и мафия! Круто! Двадцать!",
        "vysotsky": "Двадцать... Круглая дата! Пора подвигов! Двадцать!",
        "shnurov": "Двадцать! Двадцатка! Нормально посидели! Двадцать!",
        "kirkorov": "Двадцать! Двадцать баллов из двадцати! Идеально! Двадцать!",
        "leps": "Двадцать... Ревущие двадцатые... Эпоха! Двадцать!",
        "baskov": "Двадцать! Двадцать роз для любимой! Романтика! Двадцать!",
    },
    21: {
        "brezhnev": "Двадцать один... Двадцать первый съезд партии... Исторический! Двадцать один!",
        "galkin": "Очко! Двадцать одно! Блэкджек! Выиграли! Двадцать один!",
        "pugacheva": "Двадцать один! Двадцать первый век! Мы в будущем! Двадцать один!",
        "vinni": "Двадцать один... Очко! Хватит, больше мёда не влезет! Двадцать один!",
        "zhirinovsky": "Двадцать один! Совершеннолетие везде! Равенство! Двадцать один!",
    },
    22: {
        "brezhnev": "Двадцать два... Двадцать второго июня... Помним... Двадцать два!",
        "galkin": "Двадцать два! Утята! Жили у бабуси два весёлых гуся! Двадцать два!",
        "pugacheva": "Двадцать два! Два лебедя! Любовь! Двадцать два!",
        "vinni": "Двадцать два... Два утёнка! Кря-кря! Друзья Пятачка! Двадцать два!",
        "zhirinovsky": "Двадцать два! Двадцать второе июня! Помним! Скорбим! Двадцать два!",
    },
    23: {
        "brezhnev": "Двадцать три... Двадцать три года в партии... Стаж! Двадцать три!",
        "galkin": "Двадцать три! Майкл Джордан! Легенда баскетбола! Двадцать три!",
        "pugacheva": "Двадцать три февраля! Мужской праздник! Поздравляю! Двадцать три!",
        "vinni": "Двадцать три... Много шагов до дома! Устанешь! Двадцать три!",
        "zhirinovsky": "Двадцать три! День защитника Отечества! Армия! Двадцать три!",
    },
    24: {
        "brezhnev": "Двадцать четыре... Двадцать четыре часа в сутках работаем! Двадцать четыре!",
        "galkin": "Двадцать четыре часа в сутках! И все мало для творчества! Двадцать четыре!",
        "pugacheva": "Двадцать четыре кадра в секунду! Кино! Красота! Двадцать четыре!",
        "vinni": "Двадцать четыре... Целый день! А когда же обед? Двадцать четыре!",
        "zhirinovsky": "Двадцать четыре! Круглосуточно работаем! Без выходных! Двадцать четыре!",
    },
    25: {
        "brezhnev": "Двадцать пять... Опять двадцать пять... Как на съезде... Двадцать пять!",
        "galkin": "Опять двадцать пять! Заново здорово! По новой! Двадцать пять!",
        "pugacheva": "Двадцать пять! Четверть века! Юбилей! Двадцать пять!",
        "vinni": "Двадцать пять... Опять двадцать пять... Опять за мёдом! Двадцать пять!",
        "zhirinovsky": "Двадцать пять! Серебряная свадьба! Верность! Двадцать пять!",
    },
    26: {
        "brezhnev": "Двадцать шесть... Бакинские комиссары... Герои! Двадцать шесть!",
        "galkin": "Двадцать шесть бакинских комиссаров! История! Двадцать шесть!",
        "pugacheva": "Двадцать шесть! Алфавит почти! Букв немного больше! Двадцать шесть!",
        "vinni": "Двадцать шесть... Много букв! В слове мёд всего три! Двадцать шесть!",
        "zhirinovsky": "Двадцать шесть! Комиссары! Революция! История! Двадцать шесть!",
    },
    27: {
        "brezhnev": "Двадцать семь... Молодые погибали в этом возрасте... Помним! Двадцать семь!",
        "galkin": "Двадцать семь! Клуб двадцати семи! Рок-звёзды! Но мы живём! Двадцать семь!",
        "pugacheva": "Двадцать семь! Рок-звёзды уходили... Но не я! Я вечная! Двадцать семь!",
        "vinni": "Двадцать семь... Три по девять! Математика! Сложно! Двадцать семь!",
        "zhirinovsky": "Двадцать семь! Возраст свершений! Вперёд! Двадцать семь!",
    },
    28: {
        "brezhnev": "Двадцать восемь... Февраль короткий... Но дела большие! Двадцать восемь!",
        "galkin": "Двадцать восемь! Февраль! Иногда двадцать девять! Двадцать восемь!",
        "pugacheva": "Двадцать восемь! Самый короткий месяц! Но самый романтичный! Двадцать восемь!",
        "vinni": "Двадцать восемь... Февраль коротковат! Мёда съесть не успеешь! Двадцать восемь!",
        "zhirinovsky": "Двадцать восемь! Февраль! Короткий! Эффективный! Двадцать восемь!",
    },
    29: {
        "brezhnev": "Двадцать девять... Високосный день... Редкость, товарищи! Двадцать девять!",
        "galkin": "Двадцать девять! Високосный! Раз в четыре года! Редкость! Двадцать девять!",
        "pugacheva": "Двадцать девять! Редкий день! Как я! Двадцать девять!",
        "vinni": "Двадцать девять... Раз в четыре года! Редкий гость! Как мёд зимой! Двадцать девять!",
        "zhirinovsky": "Двадцать девять! Високосный! Особенный! Двадцать девять!",
    },
    30: {
        "brezhnev": "Тридцать... Тридцать лет в руководстве... Опыт! Тридцать!",
        "galkin": "Тридцать! За тридевять земель! Сказка! Тридцать!",
        "pugacheva": "Тридцать! Бальзаковский возраст! Расцвет! Тридцать!",
        "vinni": "Тридцать... Тридцать шагов до мёда! Уже близко! Тридцать!",
        "zhirinovsky": "Тридцать! Возраст политика! Карьера! Тридцать!",
    },
    31: {
        "brezhnev": "Тридцать один... Новый год скоро... Поздравления готовим! Тридцать один!",
        "galkin": "Тридцать один декабря! Новый год! Ёлка! Оливье! Тридцать один!",
        "pugacheva": "Тридцать один! Новогодний огонёк! Я там! Тридцать один!",
        "vinni": "Тридцать один... Последний день года! Пора итоги подводить! Тридцать один!",
        "zhirinovsky": "Тридцать один! Новый год! Подведём итоги! Тридцать один!",
    },
    32: {
        "brezhnev": "Тридцать два... Зубы у человека... Улыбаемся, товарищи! Тридцать два!",
        "galkin": "Тридцать два зуба! Улыбка на миллион! Тридцать два!",
        "pugacheva": "Тридцать два! Зубки! Улыбка примадонны! Тридцать два!",
        "vinni": "Тридцать два... Зубы! Чтобы мёд есть! Хотя он и так тает! Тридцать два!",
        "zhirinovsky": "Тридцать два! Полный комплект! Здоровье! Тридцать два!",
    },
    33: {
        "brezhnev": "Тридцать три... Тридцать три богатыря... Наша армия! Тридцать три!",
        "galkin": "Тридцать три богатыря! Пушкин! Классика! Тридцать три!",
        "pugacheva": "Тридцать три! Возраст Христа! Мудрость приходит! Тридцать три!",
        "vinni": "Тридцать три богатыря! Много! И все хотят мёда! Тридцать три!",
        "zhirinovsky": "Тридцать три! Богатыри! Сила русская! Тридцать три!",
    },
    34: {
        "brezhnev": "Тридцать четыре... Хороший возраст для работы... Тридцать четыре!",
        "galkin": "Тридцать четыре! Расцвет сил! Энергия! Тридцать четыре!",
        "pugacheva": "Тридцать четыре! Прекрасный возраст! Тридцать четыре!",
        "vinni": "Тридцать четыре... Хороший возраст для медведя! Тридцать четыре!",
        "zhirinovsky": "Тридцать четыре! Возраст свершений! Тридцать четыре!",
    },
    35: {
        "brezhnev": "Тридцать пять... Карлсон говорил - в расцвете сил... Тридцать пять!",
        "galkin": "Тридцать пять! Мужчина в расцвете сил! Карлсон! Тридцать пять!",
        "pugacheva": "Тридцать пять! Женщина в самом соку! Тридцать пять!",
        "vinni": "Тридцать пять... Как Карлсон! В расцвете сил! Можно летать за мёдом! Тридцать пять!",
        "zhirinovsky": "Тридцать пять! Расцвет! Энергия! Сила! Тридцать пять!",
    },
    36: {
        "brezhnev": "Тридцать шесть... Нормальная температура... Здоровье! Тридцать шесть!",
        "galkin": "Тридцать шесть и шесть! Норма! Здоровы! Тридцать шесть!",
        "pugacheva": "Тридцать шесть! Температура нормальная! Можно на сцену! Тридцать шесть!",
        "vinni": "Тридцать шесть... Это нормально! Не болеем! Мёд помогает! Тридцать шесть!",
        "zhirinovsky": "Тридцать шесть! Норма! Здоровье нации! Тридцать шесть!",
    },
    37: {
        "brezhnev": "Тридцать семь... Небольшая температура... Чай с лимоном! Тридцать семь!",
        "galkin": "Тридцать семь! Температурим! Чай с малиной! Тридцать семь!",
        "pugacheva": "Тридцать семь! Жар! Под одеяло! Концерт отменяется! Шучу! Тридцать семь!",
        "vinni": "Тридцать семь... Кажется, заболеваю... Срочно нужен мёд! Тридцать семь!",
        "zhirinovsky": "Тридцать семь! Температура! Лечиться надо! Тридцать семь!",
    },
    38: {
        "brezhnev": "Тридцать восемь... Попугаев в удаве... Мультфильм хороший! Тридцать восемь!",
        "galkin": "Тридцать восемь попугаев! А в жирафах? Мультик! Тридцать восемь!",
        "pugacheva": "Тридцать восемь попугаев! Удав! Смешно! Тридцать восемь!",
        "vinni": "Тридцать восемь попугаев... А в медведях сколько? Интересно! Тридцать восемь!",
        "zhirinovsky": "Тридцать восемь! Попугаи! Удав! Советский мультфильм! Классика! Тридцать восемь!",
    },
    39: {
        "brezhnev": "Тридцать девять... Высокая температура... Врача вызываем! Тридцать девять!",
        "galkin": "Тридцать девять ступенек! Хичкок! Триллер! Тридцать девять!",
        "pugacheva": "Тридцать девять! Последний перед сороковником! Тридцать девять!",
        "vinni": "Тридцать девять... Высокая температура! Точно нужен мёд с молоком! Тридцать девять!",
        "zhirinovsky": "Тридцать девять! Ступеньки! Хичкок! Кино! Тридцать девять!",
    },
    40: {
        "brezhnev": "Сорок... Сорок сороков московских... Колокола звонят! Сорок!",
        "galkin": "Сорок сороков! Московские колокола! Сороковник! Сорок!",
        "pugacheva": "Сорок! Али-Баба и сорок разбойников! Сказка! Сорок!",
        "vinni": "Сорок... Сорок сорок! Это птицы такие! Стрекочут! Сорок!",
        "zhirinovsky": "Сорок! Сорок разбойников! Али-Баба! Порядок навести! Сорок!",
    },
    41: {
        "brezhnev": "Сорок один... Сорок первый год... Война началась... Помним! Сорок один!",
        "galkin": "Сорок один! Ем один! Мама на работе! Сорок один!",
        "pugacheva": "Сорок один! Сама по себе! Независимая! Сорок один!",
        "vinni": "Сорок один... Ем один... Грустно без друзей... Сорок один!",
        "zhirinovsky": "Сорок один! Сорок первый год! Помним! Сорок один!",
    },
    42: {
        "brezhnev": "Сорок два... Ответ на главный вопрос... Философия! Сорок два!",
        "galkin": "Сорок два! Ответ на главный вопрос жизни и вселенной! Сорок два!",
        "pugacheva": "Сорок два! Автостопом по галактике! Космос! Сорок два!",
        "vinni": "Сорок два... Ответ на всё! Но какой был вопрос про мёд? Сорок два!",
        "zhirinovsky": "Сорок два! Главный ответ! Философия! Сорок два!",
    },
    43: {
        "brezhnev": "Сорок три... Сорок третий - год перелома в войне! Сорок три!",
        "galkin": "Сорок три! Растём потихоньку! Вперёд! Сорок три!",
        "pugacheva": "Сорок три! Элегантность! Стиль! Сорок три!",
        "vinni": "Сорок три... Уже большой медведь! Много мёда нужно! Сорок три!",
        "zhirinovsky": "Сорок три! Год победы близок! Сорок три!",
    },
    44: {
        "brezhnev": "Сорок четыре... Два стула... На чём сидеть будем? Сорок четыре!",
        "galkin": "Сорок четыре! Стульчики! Два стула! Выбирай! Сорок четыре!",
        "pugacheva": "Сорок четыре! Четыре четвёрки почти! Красиво! Сорок четыре!",
        "vinni": "Сорок четыре... Два стула! Один для меня, один для Пятачка! Сорок четыре!",
        "zhirinovsky": "Сорок четыре! Два стула! Выбор! Решение! Сорок четыре!",
    },
    45: {
        "brezhnev": "Сорок пять... Год Победы! Слава героям! Сорок пять!",
        "galkin": "Сорок пять! Баба ягодка опять! Вторая молодость! Сорок пять!",
        "pugacheva": "Сорок пять! Ягодка! И какая ягодка! Сочная! Сорок пять!",
        "vinni": "Сорок пять... Ягодка! Малинка! Вкусно! К чаю с мёдом! Сорок пять!",
        "zhirinovsky": "Сорок пять! Год Победы! Слава! Сорок пять!",
    },
    46: {
        "brezhnev": "Сорок шесть... Хромосом у человека... Наука! Сорок шесть!",
        "galkin": "Сорок шесть хромосом! Человеческий набор! Генетика! Сорок шесть!",
        "pugacheva": "Сорок шесть! Мудрость приходит! Опыт! Сорок шесть!",
        "vinni": "Сорок шесть... А у медведей сколько хромосом? Не помню! Сорок шесть!",
        "zhirinovsky": "Сорок шесть! Генетика! Наука! Прогресс! Сорок шесть!",
    },
    47: {
        "brezhnev": "Сорок семь... АК-47... Надёжное оружие! Сорок семь!",
        "galkin": "Сорок семь! Баба ягодка совсем! Созрела! Сорок семь!",
        "pugacheva": "Сорок семь! Калашников! Но я за мир! Сорок семь!",
        "vinni": "Сорок семь... Почти полтинник! Много мёда съедено! Сорок семь!",
        "zhirinovsky": "Сорок семь! АК-47! Легенда! Калашников! Сорок семь!",
    },
    48: {
        "brezhnev": "Сорок восемь... Делим пополам... Справедливость! Сорок восемь!",
        "galkin": "Сорок восемь! Половинку просим! Делим честно! Сорок восемь!",
        "pugacheva": "Сорок восемь! Делим пополам! Щедрость! Сорок восемь!",
        "vinni": "Сорок восемь... Половинку мёда Пятачку отдам! Сорок восемь!",
        "zhirinovsky": "Сорок восемь! Поровну! Справедливость! Сорок восемь!",
    },
    49: {
        "brezhnev": "Сорок девять... Семью семь... Таблица умножения! Сорок девять!",
        "galkin": "Сорок девять! Семью семь! Школьная математика! Сорок девять!",
        "pugacheva": "Сорок девять! Квадрат семёрки! Магия! Сорок девять!",
        "vinni": "Сорок девять... Семь раз по семь! Много считать! Голова кружится! Сорок девять!",
        "zhirinovsky": "Сорок девять! Математика! Образование! Сорок девять!",
    },
    50: {
        "brezhnev": "Пятьдесят... Полвека! Юбилей! Награды вручаем! Пятьдесят!",
        "galkin": "Полтинник! Полвека! Золотой юбилей! Пятьдесят!",
        "pugacheva": "Пятьдесят! Юбилей! Золото! Бриллианты! Пятьдесят!",
        "vinni": "Пятьдесят... Полтинник! Круглое число! Как горшочек! Пятьдесят!",
        "zhirinovsky": "Пятьдесят! Полвека! Юбилей! Достижения! Пятьдесят!",
    },
    51: {
        "brezhnev": "Пятьдесят один... Один после юбилея... Работаем дальше! Пятьдесят один!",
        "galkin": "Пятьдесят один! После юбилея! Жизнь продолжается! Пятьдесят один!",
        "pugacheva": "Пятьдесят один оттенок! Ой, это другое! Пятьдесят один!",
        "vinni": "Пятьдесят один... Полтинник плюс один горшочек! Пятьдесят один!",
        "zhirinovsky": "Пятьдесят один! После юбилея! Вперёд! Пятьдесят один!",
    },
    52: {
        "brezhnev": "Пятьдесят два... Недель в году... Пятьдесят два!",
        "galkin": "Пятьдесят два! Колода карт! Полный набор! Пятьдесят два!",
        "pugacheva": "Пятьдесят две недели! Пятьдесят два концерта! Пятьдесят два!",
        "vinni": "Пятьдесят два... Как карт в колоде! Можно в дурака играть! Пятьдесят два!",
        "zhirinovsky": "Пятьдесят два! Недели в году! Работа! Пятьдесят два!",
    },
    53: {
        "brezhnev": "Пятьдесят три... Год смерти Сталина... История! Пятьдесят три!",
        "galkin": "Пятьдесят три! Герби на жуке! Фольксваген! Гонки! Пятьдесят три!",
        "pugacheva": "Пятьдесят три! Машинка Герби! Мило! Пятьдесят три!",
        "vinni": "Пятьдесят три... Машинка Герби! Бибип! Поехали за мёдом! Пятьдесят три!",
        "zhirinovsky": "Пятьдесят три! Пятьдесят третий год! История! Пятьдесят три!",
    },
    54: {
        "brezhnev": "Пятьдесят четыре... Хороший год был... Помню! Пятьдесят четыре!",
        "galkin": "Студия 54! Дискотека! Танцуем! Пятьдесят четыре!",
        "pugacheva": "Пятьдесят четыре! Студия! Танцы! Музыка! Пятьдесят четыре!",
        "vinni": "Пятьдесят четыре... Это много мёда! Много-много! Пятьдесят четыре!",
        "zhirinovsky": "Пятьдесят четыре! Студия! Культура! Пятьдесят четыре!",
    },
    55: {
        "brezhnev": "Пятьдесят пять... Скорость на трассе... Аккуратнее, товарищи! Пятьдесят пять!",
        "galkin": "Пятьдесят пять! Перчатки! Пять пальцев дважды! Пятьдесят пять!",
        "pugacheva": "Пятьдесят пять! Ограничение скорости! Но я лечу! Пятьдесят пять!",
        "vinni": "Пятьдесят пять... Пять да пять! Две лапы! Обнять горшочек! Пятьдесят пять!",
        "zhirinovsky": "Пятьдесят пять! Скорость! Ограничение! Соблюдаем! Пятьдесят пять!",
    },
    56: {
        "brezhnev": "Пятьдесят шесть... Пятьдесят шестой год... Венгрия... Сложно было! Пятьдесят шесть!",
        "galkin": "Пятьдесят шесть! Вперёд! Не останавливаемся! Пятьдесят шесть!",
        "pugacheva": "Пятьдесят шесть! Возраст мудрости и красоты! Пятьдесят шесть!",
        "vinni": "Пятьдесят шесть... Хорошее число! Делится на разное! Пятьдесят шесть!",
        "zhirinovsky": "Пятьдесят шесть! Пятьдесят шестой год! История! Пятьдесят шесть!",
    },
    57: {
        "brezhnev": "Пятьдесят семь... Спутник запустили! Космос наш! Пятьдесят семь!",
        "galkin": "Пятьдесят семь! Хайнц! Пятьдесят семь сортов кетчупа! Пятьдесят семь!",
        "pugacheva": "Пятьдесят семь сортов! А песен у меня больше! Пятьдесят семь!",
        "vinni": "Пятьдесят семь сортов кетчупа... А сортов мёда сколько? Больше! Пятьдесят семь!",
        "zhirinovsky": "Пятьдесят семь! Спутник! Космос! СССР! Пятьдесят семь!",
    },
    58: {
        "brezhnev": "Пятьдесят восемь... Почти шестьдесят... Юбилей скоро! Пятьдесят восемь!",
        "galkin": "Пятьдесят восемь! Почти шестьдесят! Готовимся! Пятьдесят восемь!",
        "pugacheva": "Пятьдесят восемь! Элегантность! Грация! Пятьдесят восемь!",
        "vinni": "Пятьдесят восемь... До шестидесяти чуть-чуть осталось! Пятьдесят восемь!",
        "zhirinovsky": "Пятьдесят восемь! Почти юбилей! Подготовка! Пятьдесят восемь!",
    },
    59: {
        "brezhnev": "Пятьдесят девять... Последний перед юбилеем... Готовимся! Пятьдесят девять!",
        "galkin": "Пятьдесят девять! Финишная прямая! Юбилей завтра! Пятьдесят девять!",
        "pugacheva": "Пятьдесят девять! Завтра шестьдесят! Волнительно! Пятьдесят девять!",
        "vinni": "Пятьдесят девять... Один шаг до круглой даты! Пятьдесят девять!",
        "zhirinovsky": "Пятьдесят девять! Последний рывок! Юбилей! Пятьдесят девять!",
    },
    60: {
        "brezhnev": "Шестьдесят... Пенсия... Но работать продолжаем! Шестьдесят!",
        "galkin": "Шестьдесят! Пенсионер! Но мы ещё молоды душой! Шестьдесят!",
        "pugacheva": "Шестьдесят! Бриллиантовый возраст! Королева! Шестьдесят!",
        "vinni": "Шестьдесят... Можно отдыхать и есть мёд целый день! Шестьдесят!",
        "zhirinovsky": "Шестьдесят! Пенсия?! Какая пенсия! Работаем! Шестьдесят!",
    },
    61: {
        "brezhnev": "Шестьдесят один... Гагарин полетел! Поехали! Шестьдесят один!",
        "galkin": "Шестьдесят один! Гагарин! Космос! Поехали! Шестьдесят один!",
        "pugacheva": "Шестьдесят один! Гагарин! Звёзды! Полёт! Шестьдесят один!",
        "vinni": "Шестьдесят один... Поехали! В космос за космическим мёдом! Шестьдесят один!",
        "zhirinovsky": "Шестьдесят один! Гагарин! Триумф! СССР! Шестьдесят один!",
    },
    62: {
        "brezhnev": "Шестьдесят два... Карибский кризис... Выстояли! Шестьдесят два!",
        "galkin": "Шестьдесят два! Жизнь продолжается! Вперёд! Шестьдесят два!",
        "pugacheva": "Шестьдесят два! Жизнь прекрасна! Творчество! Шестьдесят два!",
        "vinni": "Шестьдесят два... Дорога длинная! Идём за мёдом! Шестьдесят два!",
        "zhirinovsky": "Шестьдесят два! Карибский кризис! Выстояли! Шестьдесят два!",
    },
    63: {
        "brezhnev": "Шестьдесят три... Возраст мудрости... Опыт накоплен! Шестьдесят три!",
        "galkin": "Шестьдесят три! Мудрость! Спокойствие! Шестьдесят три!",
        "pugacheva": "Шестьдесят три! Зрелость и красота! Гармония! Шестьдесят три!",
        "vinni": "Шестьдесят три... Мудрый медведь! Знаю где лучший мёд! Шестьдесят три!",
        "zhirinovsky": "Шестьдесят три! Мудрость! Опыт! Знания! Шестьдесят три!",
    },
    64: {
        "brezhnev": "Шестьдесят четыре... Шахматная доска... Гроссмейстеры наши! Шестьдесят четыре!",
        "galkin": "Шестьдесят четыре клетки! Шахматы! Гамбит! Шестьдесят четыре!",
        "pugacheva": "Шестьдесят четыре! Шах и мат! Королева! Я! Шестьдесят четыре!",
        "vinni": "Шестьдесят четыре клетки... Как на доске! Много! Шестьдесят четыре!",
        "zhirinovsky": "Шестьдесят четыре! Шахматы! Интеллект! Шестьдесят четыре!",
    },
    65: {
        "brezhnev": "Шестьдесят пять... Пенсионный возраст... Заслуженный отдых! Шестьдесят пять!",
        "galkin": "Шестьдесят пять! Пенсия официальная! Но мы работаем! Шестьдесят пять!",
        "pugacheva": "Шестьдесят пять! Пенсия? Какая пенсия! На сцену! Шестьдесят пять!",
        "vinni": "Шестьдесят пять... Пора на пенсию? Но мёд сам себя не съест! Шестьдесят пять!",
        "zhirinovsky": "Шестьдесят пять! Пенсия! Реформа! Обсудим! Шестьдесят пять!",
    },
    66: {
        "brezhnev": "Шестьдесят шесть... Валенки тёплые... Зима, товарищи! Шестьдесят шесть!",
        "galkin": "Шестьдесят шесть! Валенки! Route 66! Дорога! Шестьдесят шесть!",
        "pugacheva": "Шестьдесят шесть! Валенки-валенки! Эх, частушка! Шестьдесят шесть!",
        "vinni": "Шестьдесят шесть... Валенки тёплые! Зимой хорошо с мёдом! Шестьдесят шесть!",
        "zhirinovsky": "Шестьдесят шесть! Route 66! Америка! Но наши дороги лучше! Шестьдесят шесть!",
    },
    67: {
        "brezhnev": "Шестьдесят семь... Год юбилея революции... Помним! Шестьдесят семь!",
        "galkin": "Шестьдесят семь! Революция! Октябрь! История! Шестьдесят семь!",
        "pugacheva": "Шестьдесят семь! Исторический год! Перемены! Шестьдесят семь!",
        "vinni": "Шестьдесят семь... Давно это было! История! Шестьдесят семь!",
        "zhirinovsky": "Шестьдесят семь! Революция! История! Уроки! Шестьдесят семь!",
    },
    68: {
        "brezhnev": "Шестьдесят восемь... Пражская весна... Сложный год! Шестьдесят восемь!",
        "galkin": "Шестьдесят восемь! Шестидесятые! Эпоха перемен! Шестьдесят восемь!",
        "pugacheva": "Шестьдесят восемь! Весна! Цветы! Любовь! Шестьдесят восемь!",
        "vinni": "Шестьдесят восемь... Весна! Цветы! Пчёлы! Мёд будет! Шестьдесят восемь!",
        "zhirinovsky": "Шестьдесят восемь! Прага! Весна! Сложно! Шестьдесят восемь!",
    },
    69: {
        "brezhnev": "Шестьдесят девять... Симметрия... Как инь и янь! Шестьдесят девять!",
        "galkin": "Шестьдесят девять! Туда-сюда! Перевертыш! Инь-янь! Шестьдесят девять!",
        "pugacheva": "Шестьдесят девять! Гармония! Симметрия! Красота! Шестьдесят девять!",
        "vinni": "Шестьдесят девять... Перевернёшь - то же самое! Забавно! Шестьдесят девять!",
        "zhirinovsky": "Шестьдесят девять! Симметрия! Баланс! Шестьдесят девять!",
    },
    70: {
        "brezhnev": "Семьдесят... Платиновый юбилей... Награды! Ордена! Семьдесят!",
        "galkin": "Семьдесят! Топор в пне! Юбилей! Круглая дата! Семьдесят!",
        "pugacheva": "Семьдесят! Юбилей! Платина! Бриллианты! Семьдесят!",
        "vinni": "Семьдесят... Юбилей! Много мёда на праздник! Семьдесят!",
        "zhirinovsky": "Семьдесят! Юбилей! Достижения! Награды! Семьдесят!",
    },
    71: {
        "brezhnev": "Семьдесят один... После юбилея продолжаем работать! Семьдесят один!",
        "galkin": "Семьдесят один! Дедушка активный! Жизнь продолжается! Семьдесят один!",
        "pugacheva": "Семьдесят один! Жизнь прекрасна! Творим! Семьдесят один!",
        "vinni": "Семьдесят один... Дедушка-медведь! Мудрый! Семьдесят один!",
        "zhirinovsky": "Семьдесят один! После юбилея! Работа! Семьдесят один!",
    },
    72: {
        "brezhnev": "Семьдесят два... Мир голубям! Пикассо рисовал! Семьдесят два!",
        "galkin": "Семьдесят два! Голуби мира! Пикассо! Семьдесят два!",
        "pugacheva": "Семьдесят два голубя! Мир! Любовь! Семьдесят два!",
        "vinni": "Семьдесят два голубя... Много птичек! Воркуют! Семьдесят два!",
        "zhirinovsky": "Семьдесят два! Голуби мира! Пикассо! Искусство! Семьдесят два!",
    },
    73: {
        "brezhnev": "Семьдесят три... Хорошее число... Работаем, товарищи! Семьдесят три!",
        "galkin": "Семьдесят три! Шелдон говорит - лучшее число! Базинга! Семьдесят три!",
        "pugacheva": "Семьдесят три! Теория большого взрыва! Наука! Семьдесят три!",
        "vinni": "Семьдесят три... Шелдон говорит - лучшее! А я люблю мёд! Семьдесят три!",
        "zhirinovsky": "Семьдесят три! Шелдон! Наука! Прогресс! Семьдесят три!",
    },
    74: {
        "brezhnev": "Семьдесят четыре... Возраст государственных деятелей! Семьдесят четыре!",
        "galkin": "Семьдесят четыре! Молодцом! Бодрячком! Семьдесят четыре!",
        "pugacheva": "Семьдесят четыре! Энергия! Сила! Красота! Семьдесят четыре!",
        "vinni": "Семьдесят четыре... Бодрый медведь! Ещё побегаем! Семьдесят четыре!",
        "zhirinovsky": "Семьдесят четыре! Энергия! Работа! Семьдесят четыре!",
    },
    75: {
        "brezhnev": "Семьдесят пять... Бриллиантовая свадьба! Любовь на века! Семьдесят пять!",
        "galkin": "Семьдесят пять! Бриллиантовая свадьба! Любовь! Семьдесят пять!",
        "pugacheva": "Семьдесят пять! Бриллианты! Мои любимые! Семьдесят пять!",
        "vinni": "Семьдесят пять... Бриллианты? А мёд вкуснее! Семьдесят пять!",
        "zhirinovsky": "Семьдесят пять! Юбилей! Бриллианты! Семьдесят пять!",
    },
    76: {
        "brezhnev": "Семьдесят шесть... Тромбоны в оркестре... Музыка! Семьдесят шесть!",
        "galkin": "Семьдесят шесть тромбонов! Оркестр! Парад! Семьдесят шесть!",
        "pugacheva": "Семьдесят шесть тромбонов! Музыка! Громко! Семьдесят шесть!",
        "vinni": "Семьдесят шесть тромбонов... Громко! Уши заложило! Семьдесят шесть!",
        "zhirinovsky": "Семьдесят шесть! Тромбоны! Оркестр! Парад! Семьдесят шесть!",
    },
    77: {
        "brezhnev": "Семьдесят семь... Счастливое число... Удача! Семьдесят семь!",
        "galkin": "Семьдесят семь! Топорики! Джекпот! Удача! Семьдесят семь!",
        "pugacheva": "Семьдесят семь! Удача! Везение! Звёзды сошлись! Семьдесят семь!",
        "vinni": "Семьдесят семь... Два топорика! Дрова для камина! Тепло! Семьдесят семь!",
        "zhirinovsky": "Семьдесят семь! Удача! Победа! Семьдесят семь!",
    },
    78: {
        "brezhnev": "Семьдесят восемь... Оборотов у пластинки... Музыка! Семьдесят восемь!",
        "galkin": "Семьдесят восемь оборотов! Винил! Ретро! Семьдесят восемь!",
        "pugacheva": "Семьдесят восемь! Винил! Мои первые записи! Ностальгия! Семьдесят восемь!",
        "vinni": "Семьдесят восемь оборотов... Пластинка кружится! Музыка! Семьдесят восемь!",
        "zhirinovsky": "Семьдесят восемь! Винил! Классика! Семьдесят восемь!",
    },
    79: {
        "brezhnev": "Семьдесят девять... Почти восемьдесят... Юбилей готовим! Семьдесят девять!",
        "galkin": "Семьдесят девять! Почти восьмой десяток! Скоро юбилей! Семьдесят девять!",
        "pugacheva": "Семьдесят девять! На пороге восьмидесяти! Волнительно! Семьдесят девять!",
        "vinni": "Семьдесят девять... Один шаг до восьмидесяти! Круглая дата! Семьдесят девять!",
        "zhirinovsky": "Семьдесят девять! Последний рывок! Юбилей! Семьдесят девять!",
    },
    80: {
        "brezhnev": "Восемьдесят... Бабушка... Пирожки печёт... Вкусно! Восемьдесят!",
        "galkin": "Восемьдесят! Бабушка! Пирожки! Любовь! Восемьдесят!",
        "pugacheva": "Восемьдесят! Королева! Императрица! Легенда! Восемьдесят!",
        "vinni": "Восемьдесят... Бабушка печёт пирожки с мёдом! Вкуснятина! Восемьдесят!",
        "zhirinovsky": "Восемьдесят! Почтенный возраст! Уважение! Восемьдесят!",
    },
    81: {
        "brezhnev": "Восемьдесят один... Бабушка с клюшкой... Мудрая! Восемьдесят один!",
        "galkin": "Восемьдесят один! Бабка с клюшкой! Волшебница! Восемьдесят один!",
        "pugacheva": "Восемьдесят один! Волшебница! Фея! Восемьдесят один!",
        "vinni": "Восемьдесят один... Бабушка с палочкой гуляет! Мудрая! Восемьдесят один!",
        "zhirinovsky": "Восемьдесят один! Мудрость! Опыт! Восемьдесят один!",
    },
    82: {
        "brezhnev": "Восемьдесят два... Годы идут... Но дух молод! Восемьдесят два!",
        "galkin": "Восемьдесят два! Время летит! Но мы молоды! Восемьдесят два!",
        "pugacheva": "Восемьдесят два! Время ничто! Главное - душа! Восемьдесят два!",
        "vinni": "Восемьдесят два... Годы идут... Мёд кончается быстро! Восемьдесят два!",
        "zhirinovsky": "Восемьдесят два! Время! Опыт! Знания! Восемьдесят два!",
    },
    83: {
        "brezhnev": "Восемьдесят три... Счастливый возраст! Мудрость! Восемьдесят три!",
        "galkin": "Восемьдесят три! Возраст счастья! Гармония! Восемьдесят три!",
        "pugacheva": "Восемьдесят три! Счастье! Радость! Любовь! Восемьдесят три!",
        "vinni": "Восемьдесят три... Счастливый возраст! Много мёда съедено! Восемьдесят три!",
        "zhirinovsky": "Восемьдесят три! Счастье! Достижения! Восемьдесят три!",
    },
    84: {
        "brezhnev": "Восемьдесят четыре... Год Оруэлла... Книга была! Восемьдесят четыре!",
        "galkin": "Восемьдесят четыре! Оруэлл! Большой брат! Восемьдесят четыре!",
        "pugacheva": "Восемьдесят четыре! Книга страшная! Но мы живём хорошо! Восемьдесят четыре!",
        "vinni": "Восемьдесят четыре... Книжка Оруэлла! Страшная! Лучше про мёд читать! Восемьдесят четыре!",
        "zhirinovsky": "Восемьдесят четыре! Оруэлл! Предупреждение! Восемьдесят четыре!",
    },
    85: {
        "brezhnev": "Восемьдесят пять... Перестройка началась... Новые времена! Восемьдесят пять!",
        "galkin": "Восемьдесят пять! Песни молодости! Ностальгия! Восемьдесят пять!",
        "pugacheva": "Восемьдесят пять! Мои хиты того года! Помните? Восемьдесят пять!",
        "vinni": "Восемьдесят пять... Старые песни о главном! О мёде! Восемьдесят пять!",
        "zhirinovsky": "Восемьдесят пять! Перестройка! История! Восемьдесят пять!",
    },
    86: {
        "brezhnev": "Восемьдесят шесть... Чернобыль... Помним... Скорбим... Восемьдесят шесть!",
        "galkin": "Восемьдесят шесть! Чернобыль! Помним! Восемьдесят шесть!",
        "pugacheva": "Восемьдесят шесть! Тяжёлый год! Помним! Восемьдесят шесть!",
        "vinni": "Восемьдесят шесть... Год был такой... Грустный... Восемьдесят шесть!",
        "zhirinovsky": "Восемьдесят шесть! Чернобыль! Трагедия! Помним! Восемьдесят шесть!",
    },
    87: {
        "brezhnev": "Восемьдесят семь... Хороший год... Работали! Восемьдесят семь!",
        "galkin": "Восемьдесят семь! Классика! Золотой возраст! Восемьдесят семь!",
        "pugacheva": "Восемьдесят семь! Легенда! Классика! Восемьдесят семь!",
        "vinni": "Восемьдесят семь... Старый мудрый медведь! Всё знаю про мёд! Восемьдесят семь!",
        "zhirinovsky": "Восемьдесят семь! Классика! Традиции! Восемьдесят семь!",
    },
    88: {
        "brezhnev": "Восемьдесят восемь... Две бесконечности... Вечность! Восемьдесят восемь!",
        "galkin": "Восемьдесят восемь! Бабушки! Две матрёшки! Бесконечность! Восемьдесят восемь!",
        "pugacheva": "Восемьдесят восемь! Бесконечность дважды! Вечная! Восемьдесят восемь!",
        "vinni": "Восемьдесят восемь... Два бублика! Или две бабушки! Обе с пирожками! Восемьдесят восемь!",
        "zhirinovsky": "Восемьдесят восемь! Бесконечность! Вечность! Восемьдесят восемь!",
    },
    89: {
        "brezhnev": "Восемьдесят девять... Стена упала... Перемены! Восемьдесят девять!",
        "galkin": "Восемьдесят девять! Дедушкин сосед! Почти девяносто! Восемьдесят девять!",
        "pugacheva": "Восемьдесят девять! Сосед дедушки! Хороший! Восемьдесят девять!",
        "vinni": "Восемьдесят девять... Сосед! Привет соседу! У него тоже мёд есть? Восемьдесят девять!",
        "zhirinovsky": "Восемьдесят девять! Берлинская стена! История! Восемьдесят девять!",
    },
    90: {
        "brezhnev": "Девяносто! Дедушка! Самый старший! Уважение! Слава! Девяносто!",
        "galkin": "Девяносто! Дедушка! Самый старший! Король лото! Девяносто!",
        "pugacheva": "Девяносто! Дед! Патриарх! Легенда! Уважение! Девяносто!",
        "vinni": "Девяносто... Дедушка! Самый мудрый! Знает всё про мёд! Девяносто!",
        "zhirinovsky": "Девяносто! Патриарх! Уважение! Почёт! Девяносто!",
    },
}

# Simple number announcements (without jokes)
SIMPLE_NUMBERS = {
    i: f"Номер {i}!" for i in range(1, 91)
}

# Intro phrases by character
INTRO_PHRASES = {
    "brezhnev": [
        "Дорогие товарищи! Начинаем розыгрыш лотереи!",
        "Товарищи! Приготовьте карточки! Начинаем!",
    ],
    "galkin": [
        "Дамы и господа! Начинаем русское лото! Это будет незабываемо!",
        "Внимание, внимание! Шоу начинается! Лотерея!",
        "Приготовьте ваши карточки! Достаём бочонки! Поехали!",
    ],
    "pugacheva": [
        "Мои дорогие! Начинаем игру! Это будет феерично!",
        "Ну что, готовы? Примадонна объявляет номера! Начали!",
    ],
    "vinni": [
        "А не сыграть ли нам в лото? По-моему, это хорошая идея! Кто ходит в гости по утрам... Ой, это не то! Начинаем!",
        "Пух-пух-пух! Это я, Винни-Пух! Давайте играть в лото! У кого есть мёд на карточке?",
    ],
    "zhirinovsky": [
        "Так! Внимание! Я вам сейчас покажу как надо играть в лото! Слушайте внимательно!",
        "Хватит разговаривать! Начинаем лотерею! Тишина в зале!",
    ],
}

# Transition phrases by character
TRANSITION_PHRASES = {
    "brezhnev": ["Следующий номер...", "Так...", "Продолжаем, товарищи..."],
    "galkin": ["А теперь...", "Следующий номер...", "Тааак, что у нас тут...", "Крутим барабан..."],
    "pugacheva": ["Дальше...", "Следующее число...", "А вот и..."],
    "vinni": ["Так-так-так...", "А теперь...", "Интересно, что выпадет...", "Пум-пурум..."],
    "zhirinovsky": ["Дальше!", "Следующий!", "Так!", "Внимание!"],
}

# Attention-getting jokes when room is noisy (20+ jokes by character)
ATTENTION_JOKES = {
    "brezhnev": [
        "Товарищи! Тишина в зале! Это не митинг!",
        "Дорогие друзья, прошу внимания! Партия ждёт!",
        "Товарищи, соблюдаем дисциплину! Как на съезде!",
        "Шум недопустим! Работаем, товарищи!",
        "Тише, товарищи! Это серьёзное мероприятие!",
    ],
    "galkin": [
        "Эй-эй-эй! Тише! Я здесь главная звезда!",
        "Ау! Вы меня слышите? Или мне петь начать?",
        "Народ, потише! Шоу продолжается!",
        "Эй, на галёрке! Тишина!",
        "Та-дам! Внимание на сцену! Я жду!",
        "Секундочку! Кто тут шумит? Выйти из зала!",
        "Публика, внимание! Сейчас будет самое интересное!",
    ],
    "pugacheva": [
        "Так, мои дорогие! Тишина! Примадонна говорит!",
        "Эй! Я здесь пою или вы? Тихо!",
        "Милые мои, потише! Я теряю голос от вашего шума!",
        "Так, кто там шумит? Автограф потом!",
        "Дорогие, внимание! Это не базар!",
    ],
    "vinni": [
        "Ой-ой-ой! Как шумно! У меня от шума опилки из головы сыпятся!",
        "Друзья, потише! Пчёлы могут услышать и прилететь!",
        "Тише-тише! Кролик нервничает от такого шума!",
        "Ребята, давайте потише? Мёд любит тишину!",
        "Ой, как громко! Даже Иа-Иа бы расстроился!",
        "Пух-пух-пух! Тихо! Я забыл какой номер был!",
    ],
    "zhirinovsky": [
        "Тихо! Я сказал тихо! Это безобразие!",
        "Хватит шуметь! Слушайте сюда!",
        "Это что за балаган?! Тишина немедленно!",
        "Я требую тишины! Немедленно!",
        "Так! Кто шумит - выйти вон! Я серьёзно!",
        "Это недопустимо! Где дисциплина?!",
        "Слушайте меня внимательно! Хватит болтать!",
    ],
}

# Starting attention message
START_ATTENTION_MESSAGE = {
    "brezhnev": "Дорогие товарищи! Прошу тишины! Начинается важное мероприятие! Лотерея!",
    "galkin": "Внимание-внимание! Дамы и господа! Прошу тишины! Начинается грандиозное шоу! Русское Лото!",
    "pugacheva": "Мои дорогие! Тишина в зале! Примадонна начинает! Это будет незабываемо!",
    "vinni": "Друзья! А не замолчать ли нам? Начинается игра в лото! Кто ходит в гости по утрам... Ой, не то!",
    "zhirinovsky": "Так! Всем замолчать! Я сказал - тишина! Начинается лотерея! Слушать внимательно!",
}


class NoiseMonitor:
    """Monitor room noise level using microphone."""

    def __init__(self, threshold: float = 500, sample_rate: int = 44100, chunk_size: int = 1024):
        self.threshold = threshold
        self.sample_rate = sample_rate
        self.chunk_size = chunk_size
        self.is_noisy = False
        self.current_level = 0
        self._running = False
        self._thread = None
        self._pyaudio = None
        self._stream = None

    def start(self):
        """Start monitoring noise in background thread."""
        if not PYAUDIO_AVAILABLE:
            print("  [Микрофон недоступен - режим без прослушивания]")
            return False

        try:
            self._pyaudio = pyaudio.PyAudio()
            self._stream = self._pyaudio.open(
                format=pyaudio.paInt16,
                channels=1,
                rate=self.sample_rate,
                input=True,
                frames_per_buffer=self.chunk_size,
            )
            self._running = True
            self._thread = threading.Thread(target=self._monitor_loop, daemon=True)
            self._thread.start()
            print("  [Микрофон активен - слушаю комнату]")
            return True
        except Exception as e:
            print(f"  [Ошибка микрофона: {e}]")
            return False

    def stop(self):
        """Stop monitoring."""
        self._running = False
        if self._stream:
            self._stream.stop_stream()
            self._stream.close()
        if self._pyaudio:
            self._pyaudio.terminate()

    def _monitor_loop(self):
        """Background loop to monitor noise levels."""
        while self._running:
            try:
                data = self._stream.read(self.chunk_size, exception_on_overflow=False)
                audio_data = np.frombuffer(data, dtype=np.int16)
                self.current_level = np.abs(audio_data).mean()
                self.is_noisy = self.current_level > self.threshold
            except Exception:
                pass
            time.sleep(0.1)

    def wait_for_quiet(self, timeout: float = 60.0, check_interval: float = 0.5) -> bool:
        """Wait until room is quiet or timeout. Returns True if quiet, False if timeout."""
        if not self._running:
            return True  # No monitoring, assume quiet

        start_time = time.time()
        while time.time() - start_time < timeout:
            if not self.is_noisy:
                # Wait a bit more to confirm it's really quiet
                time.sleep(0.3)
                if not self.is_noisy:
                    return True
            time.sleep(check_interval)
        return False


async def speak_edge_tts(text: str, temp_dir: Path, voice: str, rate: str, pitch: str = "+0Hz") -> None:
    """Generate and play speech using edge-tts (fallback)."""
    import edge_tts

    audio_file = temp_dir / "speech.mp3"
    communicate = edge_tts.Communicate(text, voice, rate=rate, pitch=pitch)
    await communicate.save(str(audio_file))

    pygame.mixer.music.load(str(audio_file))
    pygame.mixer.music.play()

    while pygame.mixer.music.get_busy():
        await asyncio.sleep(0.1)


def speak_qwen_tts_clone(text: str, model, voice_prompt, temp_dir: Path) -> None:
    """Generate and play speech using Qwen3-TTS voice cloning."""
    audio_file = temp_dir / "speech.wav"

    wavs, sr = model.generate_voice_clone(
        text=text,
        language="russian",
        voice_clone_prompt=voice_prompt,
    )
    sf.write(str(audio_file), wavs[0], sr)

    pygame.mixer.music.load(str(audio_file))
    pygame.mixer.music.play()

    while pygame.mixer.music.get_busy():
        import time
        time.sleep(0.1)


def speak_qwen_tts_design(text: str, model, voice_instruct: str, temp_dir: Path) -> None:
    """Generate and play speech using Qwen3-TTS voice design."""
    audio_file = temp_dir / "speech.wav"

    wavs, sr = model.generate_voice_design(
        text=text,
        instruct=voice_instruct,
        language="russian",
    )
    sf.write(str(audio_file), wavs[0], sr)

    pygame.mixer.music.load(str(audio_file))
    pygame.mixer.music.play()

    while pygame.mixer.music.get_busy():
        import time
        time.sleep(0.1)


async def run_loto(count: int = 90, delay_min: float = 1.0, delay_max: float = 2.0,
                   use_qwen: bool = False, listen_mode: bool = False, noise_threshold: float = 500,
                   model_size: str = "large", model_type: str = "design") -> None:
    """Run the loto game with celebrity voices and optional noise monitoring."""
    pygame.mixer.init()

    # Character rotation
    characters = list(CELEBRITY_VOICES.keys())
    char_index = 0
    numbers_since_joke = 0
    next_joke_at = random.randint(3, 5)

    # Noise monitor for listen mode
    noise_monitor = None
    if listen_mode:
        noise_monitor = NoiseMonitor(threshold=noise_threshold)
        noise_monitor.start()

    # Initialize Qwen TTS if requested and available
    model = None
    voice_prompts = {}

    if use_qwen and QWEN_AVAILABLE:
        print(f"Loading Qwen3-TTS model on {QWEN_DEVICE}... (this may take a moment)")
        try:
            # Select model based on size and type preference
            size_suffix = "1.7B" if model_size == "large" else "0.6B"
            type_suffix = "VoiceDesign" if model_type == "design" else "Base"
            model_dir = f"Qwen3-TTS-12Hz-{size_suffix}-{type_suffix}"
            hf_model = f"Qwen/Qwen3-TTS-12Hz-{size_suffix}-{type_suffix}"

            # Check for local model first, then fall back to HuggingFace
            local_model_path = Path(__file__).parent / "models" / model_dir
            if local_model_path.exists():
                model_name = str(local_model_path)
                print(f"  Using local model: {model_name}")
            else:
                model_name = hf_model  # Will download from HuggingFace
                print(f"  Downloading model from HuggingFace: {model_name}")

            model = Qwen3TTSModel.from_pretrained(
                model_name,
                device_map=QWEN_DEVICE,
                dtype=QWEN_DTYPE,
                attn_implementation="sdpa",  # Works on Mac (no FlashAttention)
            )
            print(f"Model loaded!")

            if model_type == "design":
                # VoiceDesign model - use text descriptions for voice generation
                print("Using VoiceDesign mode - generating voices from descriptions")
                for char_id, char_info in CELEBRITY_VOICES.items():
                    if "voice_design" in char_info:
                        voice_prompts[char_id] = char_info["voice_design"]
                        print(f"  Voice design ready for {char_info['name']}")
                print(f"All {len(voice_prompts)} characters ready!")
            else:
                # Base model - voice cloning requires audio samples
                print("Creating voice clone prompts...")
                for char_id, char_info in CELEBRITY_VOICES.items():
                    sample_file = VOICES_DIR / char_info.get("sample_file", f"{char_id}.mp3")
                    if sample_file.exists():
                        print(f"  Loading voice sample for {char_info['name']} from {sample_file}")
                        try:
                            voice_prompts[char_id] = model.create_voice_clone_prompt(
                                ref_audio=str(sample_file),
                                ref_text=char_info["sample_text"],
                                x_vector_only_mode=False,
                            )
                        except Exception as e:
                            print(f"    Failed: {e}, will use edge-tts")
                    else:
                        print(f"  No voice sample for {char_info['name']}, will use edge-tts")

                if voice_prompts:
                    print(f"Voice cloning ready for {len(voice_prompts)} character(s)!")
                else:
                    print("No voice samples found. Place MP3 files in ./voices/ directory.")
                    print("Will use edge-tts for all characters.")
        except Exception as e:
            print(f"Qwen TTS failed to load: {e}")
            print("Falling back to edge-tts...")
            model = None

    async def speak(text: str, char: str, char_info: dict, temp_path: Path):
        """Helper to speak with current voice settings."""
        if model and char in voice_prompts:
            if model_type == "design":
                speak_qwen_tts_design(text, model, voice_prompts[char], temp_path)
            else:
                speak_qwen_tts_clone(text, model, voice_prompts[char], temp_path)
        else:
            pitch = char_info.get("edge_pitch", "+0Hz")
            await speak_edge_tts(text, temp_path, char_info["edge_voice"], char_info["edge_rate"], pitch)

    async def get_attention(temp_path: Path, char: str, char_info: dict) -> bool:
        """Try to get room's attention with exponential backoff. Returns True if quiet achieved."""
        if not noise_monitor or not noise_monitor._running:
            return True

        backoff = 1.0  # Start with 1 second
        max_backoff = 60.0  # Max 1 minute
        attempts = 0

        while noise_monitor.is_noisy and backoff <= max_backoff:
            attempts += 1
            # Pick a random attention joke
            joke = random.choice(ATTENTION_JOKES.get(char, ATTENTION_JOKES["galkin"]))
            print(f"  🔊 [Шумно! Уровень: {noise_monitor.current_level:.0f}] [{char_info['name']}] {joke}")
            await speak(joke, char, char_info, temp_path)

            # Wait with exponential backoff
            print(f"  ⏳ Ждём тишины... (попытка {attempts}, ожидание {backoff:.1f}с)")
            quiet = noise_monitor.wait_for_quiet(timeout=backoff)
            if quiet:
                print("  ✓ Тишина!")
                return True

            # Increase backoff
            backoff = min(backoff * 2, max_backoff)

            # Switch character for variety
            nonlocal char_index
            char_index = (char_index + 1) % len(characters)
            char = characters[char_index]
            char_info = CELEBRITY_VOICES[char]

        return not noise_monitor.is_noisy

    with tempfile.TemporaryDirectory() as temp_dir:
        temp_path = Path(temp_dir)

        # Starting attention message
        char = characters[char_index]
        char_info = CELEBRITY_VOICES[char]

        if listen_mode:
            start_msg = START_ATTENTION_MESSAGE[char]
            print(f"\n📢 [{char_info['name']}] {start_msg}\n")
            await speak(start_msg, char, char_info, temp_path)
            await asyncio.sleep(2.0)

            # Wait for initial quiet
            await get_attention(temp_path, char, char_info)

        # Welcome message
        intro = random.choice(INTRO_PHRASES[char])
        print(f"\n🎰 [{char_info['name']}] {intro}\n")
        await speak(intro, char, char_info, temp_path)
        await asyncio.sleep(2.0)

        # Generate random numbers
        all_numbers = list(range(1, 91))
        random.shuffle(all_numbers)
        numbers_to_call = all_numbers[:count]

        called = []
        last_number = None
        last_phrase = None
        last_char = None
        last_char_info = None

        for i, num in enumerate(numbers_to_call, 1):
            numbers_since_joke += 1
            use_joke = numbers_since_joke >= next_joke_at

            if use_joke:
                char_index = (char_index + 1) % len(characters)
                char = characters[char_index]
                char_info = CELEBRITY_VOICES[char]

                jokes = LOTO_JOKES.get(num, {})
                phrase = jokes.get(char, SIMPLE_NUMBERS[num])

                numbers_since_joke = 0
                next_joke_at = random.randint(3, 5)

                print(f"  [{i:2d}/{count}] 🎱 {num:2d} - 🎭 [{char_info['name']}] {phrase}")
            else:
                phrase = SIMPLE_NUMBERS[num]
                print(f"  [{i:2d}/{count}] 🎱 {num:2d} - {phrase}")

            await speak(phrase, char, char_info, temp_path)

            # Save for potential repeat
            last_number = num
            last_phrase = phrase
            last_char = char
            last_char_info = char_info

            called.append(num)

            # Check for noise and handle it
            if listen_mode and noise_monitor and noise_monitor.is_noisy:
                print(f"\n  🔊 Обнаружен шум! Повторяю последний номер...")
                repeat_phrase = f"Повторяю! {last_phrase}"
                print(f"  🔁 [{last_char_info['name']}] {repeat_phrase}")
                await speak(repeat_phrase, last_char, last_char_info, temp_path)

                # Try to get attention
                await get_attention(temp_path, char, char_info)

            # Delays
            if i < count:
                if i % 10 == 0:
                    print(f"\n  --- Пауза после {i} номеров ---\n")
                    await asyncio.sleep(4.0)
                else:
                    await asyncio.sleep(random.uniform(delay_min, delay_max))

        # Closing
        await asyncio.sleep(1.5)
        char = random.choice(characters)
        char_info = CELEBRITY_VOICES[char]
        closing = "Все номера названы! Проверяйте карточки! Кто выиграл?"
        print(f"\n🏆 [{char_info['name']}] {closing}")
        await speak(closing, char, char_info, temp_path)

        print(f"\n📋 Выпавшие номера: {', '.join(map(str, sorted(called)))}")

    # Cleanup
    if noise_monitor:
        noise_monitor.stop()
    pygame.mixer.quit()


def main():
    """Main entry point."""
    import argparse

    parser = argparse.ArgumentParser(description="Русское Лото с голосами знаменитостей")
    parser.add_argument("-n", "--count", type=int, default=90,
                        help="Количество чисел (по умолчанию: 90)")
    parser.add_argument("--min-delay", type=float, default=1.0,
                        help="Минимальная задержка между числами (по умолчанию: 1.0)")
    parser.add_argument("--max-delay", type=float, default=2.0,
                        help="Максимальная задержка между числами (по умолчанию: 2.0)")
    parser.add_argument("--qwen", action="store_true",
                        help="Использовать Qwen3-TTS для клонирования голосов (требует GPU)")
    parser.add_argument("--model-size", choices=["small", "large"], default="large",
                        help="Размер модели Qwen TTS: small=0.6B (быстрее), large=1.7B (качественнее)")
    parser.add_argument("--model-type", choices=["base", "design"], default="design",
                        help="Тип модели: base=клонирование голоса, design=генерация по описанию (рекомендуется)")
    parser.add_argument("--listen", action="store_true",
                        help="Слушать комнату и реагировать на шум (повторять номера, шутить)")
    parser.add_argument("--noise-threshold", type=float, default=500,
                        help="Порог шума для реакции (по умолчанию: 500)")

    args = parser.parse_args()

    print("=" * 60)
    print("     🎰 РУССКОЕ ЛОТО - ГОЛОСА ЗНАМЕНИТОСТЕЙ 🎰")
    print("=" * 60)
    print("\n  Персонажи:")
    for char_id, char_info in CELEBRITY_VOICES.items():
        print(f"    • {char_info['name']} - {char_info['description']}")
    print()
    print(f"  Количество чисел: {args.count}")
    print(f"  Задержка: {args.min_delay}-{args.max_delay} сек")
    if args.qwen and QWEN_AVAILABLE:
        size_info = "1.7B" if args.model_size == "large" else "0.6B"
        type_info = "VoiceDesign" if args.model_type == "design" else "VoiceClone"
        model_info = f"Да ({size_info}, {type_info})"
    else:
        model_info = "Нет (edge-tts)"
    print(f"  Qwen TTS: {model_info}")
    print(f"  Режим прослушивания: {'Да' if args.listen else 'Нет'}")
    if args.listen:
        print(f"  Порог шума: {args.noise_threshold}")
    print("=" * 60)

    try:
        asyncio.run(run_loto(
            count=args.count,
            delay_min=args.min_delay,
            delay_max=args.max_delay,
            use_qwen=args.qwen,
            listen_mode=args.listen,
            noise_threshold=args.noise_threshold,
            model_size=args.model_size,
            model_type=args.model_type,
        ))
    except KeyboardInterrupt:
        print("\n\n👋 Игра прервана. До свидания!")


if __name__ == "__main__":
    main()
